<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Spectrum Filter - Accessible Editor</title>
  </head>
  <body>
	  <h1 tabindex="0">Spectrum Filter - Accessible Editor</h1>
      <p tabindex="0">
        This tool replicates the functionality of the Neuro Desktop Editor
        to interact with and change the settings of the Spectrum Intellingent Filter.
        The editor has many groups of settings, each of which controls a different part of the filter.
        It was designed by Fabian Velasquez and Shuli Jones as part of MIT PPAT 2022. The code can be found at 
        <a href="https://github.com/fabianv1/fabianv1.github.io">https://github.com/fabianv1/fabianv1.github.io</a>.
      </p>
      <p tabindex="0">
        To use the editor, first plug the filter into your computer via USB. Use the "Test connectivity"
        button (accesskey t) to make sure it's connected. If the connectivity results in 'Filter not connected', please
        unplug the USB from the computer (not the device) and unplug the power from the filter pedal for 15 seconds before
        testing again. This should now lead to the filer being connected. Refresh the page to have all the parameters be read. 
        If you need to troubleshoot, check the GitHub repo README. 
      </p>
      <p tabindex="0">
        Once you're connected, use the "groups" dropdown (accesskey g) 
        to choose which group of settings you want to change. Based on this group, a set of dropdowns, checkboxes, and/or value 
        setters will appear. Changing these elements will automatically change the corresponding setting on the Spectrum Filter. 
      </p>
      <p tabindex="0">
        You can also use this tool to burn and load presets (accesskey p). Burning a preset to a particular
        number saves the current settings on the Filter to the preset of that number. Loading a preset with a
        particular number changes the current settings on the Filter to match the settings of the preset.
        Finally, you can use this tool to check if the Filter's alt button is pressed (accesskey a). When this button is pressed,
        the four knobs on the filter take on different values and the preset value changes. The preset value is also 
        reflected in the preset section.
      </p>

    <div>
      <button onclick="testMessages()" accesskey="t">Test connectivity with the filter (t)</button>
      <span id="testResult" tabindex="0"></span>
    </div>

    <p tabindex="0">
      Alt button status (a): <span id="alt-button" accesskey="a" tabindex="0">off</span>
    </p>

    <fieldset id="settings" tabindex="0">
      <legend><h2>Settings (g)</h2></legend>
      <select id="groups" accesskey="g">
        <!-- Main selector, generated by JS --> 
      </select>
      <div id="dropdowns">
        <!-- One sub-selector per main selector, also generated by JS --> 
      </div>
      <div id="checkboxes">
        <!-- One set of checkboxes per main selector, generated by JS -->
      </div>
      <div id="knobs"> 
        <!-- One set of value controls per main selector, generated by JS -->
      </div>
    </fieldset>
    
    
    <fieldset id="presets" tabindex="0">
      <legend><h2>Presets (p) </h2></legend>
      <p tabindex="0">
        Current preset index (c): <span id="current-preset" accesskey="c" tabindex="0">Getting current preset...</span>
      </p>
      <div id="presetIndex-value">
        <label>Preset index input:
          <input type="number" class="number" id="presetIndex" min="0" max="127" accesskey="p" onchange="resetPresetMessages()">
        </label>
      </div>
      <div>
        <button onclick="loadPreset(presetIndex.value)">
          Load preset at given index into filter
        </button>
        <span id="load-message" tabindex="0"></span>
      </div>
      <div>
        <button onclick="burnPreset(presetIndex.value)">
          Burn current filter settings to given preset index
        </button>
        <span id="burn-message" tabindex="0"></span>
      </div>
    </fieldset>

    <!-- The script needs to be at the end of the body so that it's 
      only called once the body divs are already created -->
    <script src="data.js"></script>
    <script src="index.js"></script>
    <script src="messages.js"></script>
    <script src="preset.js"></script>
  </body>
</html>